<script>
  const NEYNAR_API_KEY = "3F17B1A2-18B4-4EB9-8F64-301575EF94D0";

  const btnMain = document.getElementById("btnMain");
  const modal = document.getElementById("loginModal");
  const optWallet = document.getElementById("optWallet");
  const optFarcaster = document.getElementById("optFarcaster");

  let loggedIn = false;

  btnMain.addEventListener("click", () => {
    if (!loggedIn) {
      modal.style.display = "flex";
    } else {
      window.location.href = "/games/snake/index.html";
    }
  });

  // Klik WalletConnect (sementara dummy biar gak error)
  optWallet.addEventListener("click", async () => {
    alert("WalletConnect triggered (dummy dulu, biar gak blank).");
    afterLogin("WalletConnect");
  });

  // Klik Farcaster
  optFarcaster.addEventListener("click", async () => {
    try {
      const res = await fetch("https://api.neynar.com/v2/farcaster/user", {
        headers: { "api_key": NEYNAR_API_KEY }
      });
      if (res.ok) {
        afterLogin("Farcaster");
      } else {
        alert("Login Farcaster gagal");
      }
    } catch (err) {
      alert("Error Farcaster");
      console.error(err);
    }
  });

  function afterLogin(method) {
    loggedIn = true;
    btnMain.textContent = "ðŸŽ® Main Game";
    modal.style.display = "none";
    console.log("Login sukses via", method);
  }

  window.closeModal = () => modal.style.display = "none";
</script>
